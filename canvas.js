const CanvasIcon = "data:image/png;base64,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"
var blur = 0
var brightness = 1
var contrast = 1
var greyscale = 0
var hue = 0
var invert = 0
var saturate = 1
var sepia = 0


function updateCanvas(){
document.getElementsByClassName('stage_stage-wrapper_eRRuk box_box_2jjDp')[0].getElementsByTagName('*')[2].style.filter = 'blur(' + blur + 'px) ' + 'brightness(' + brightness + ') ' + 'contrast(' + contrast + ') ' + 'grayscale(' + greyscale + ') ' + 'hue-rotate(' + hue + 'deg) ' + 'invert(' + invert + ') ' + 'saturate(' + saturate + ') ' + 'sepia(' + sepia + ') '
}
function setCanvas(effect, value){
eval(effect + ' = ' + value)
updateCanvas();
}
class CanvasTheme {
    constructor(runtime) {
        this.runtime = runtime
    }

    getInfo() {
        return {
            "id": "CanvasStyles",
            "name": "Canvas",
          
             "menuIconURI": CanvasIcon,
             "blockIconURI": CanvasIcon,
          
            "blocks": [
                {
                    "opcode": "canvasStyle",
                    "blockType": "command",
                    "text": "set stage effect [effect] to [value]",
                    "arguments": {
                        "effect": {
                            "type": "string",
                            "defaultValue": "blur",
                            "menu": "effects",
                        },
                        "value": {
                            "type": "string",
                            "defaultValue": "1",
                        },
                    },
                },
                {
                    "opcode": "effect",
                    "blockType": "reporter",
                    "text": "effect [effect]",
                    "arguments": {
                        "effect": {
                            "type": "string",
                            "defaultValue": "blur",
                          "menu": "effects"
                        },
                },
                },

            ],

            "menus": {
                "effects": {
                    acceptReporters: true, 
                    items: [{text:"blur",value:"blur"}, {text:"brightness",value:"brightness"}, {text:"contrast",value:"contrast"}, {text:"greyscale",value:"greyscale"}, {text:"hue",value:"hue"}, {text:"invert",value:"invert"}, {text:"saturate",value:"saturate"}, {text:"sepia",value:"sepia"}],
                }
            }     
        };
    }

    canvasStyle({effect, value}) {

        setCanvas(effect, value)
        
    }

    effect({effect}) {
        return eval(effect)
    }
    

}

(function() {
    var extensionInstance = new CanvasTheme(window.vm.extensionManager.runtime)
    var serviceName = window.vm.extensionManager._registerInternalExtension(extensionInstance)
    window.vm.extensionManager._loadedExtensions.set(extensionInstance.getInfo().id, serviceName)
})()
